<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SGIP Eligibility & Incentive Calculator</title>
  <!-- 100% OFF‑LINE: no external CDNs, everything inline → works from a local file -->
  <style>
    /* ===== RESET & BASE ===== */
    *{box-sizing:border-box;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif}
    body{background:#f5f7fa;color:#1e293b;line-height:1.5;display:flex;flex-direction:column;min-height:100vh}
    h1,h2{font-weight:700;color:#0f172a}
    h1{font-size:clamp(1.75rem,4vw,2.75rem);text-align:center}
    h2{font-size:1.25rem;margin-bottom:.5rem}
    a{color:#004b87;text-decoration:none}
    a:hover{text-decoration:underline}
    label{font-weight:600;display:block;margin-bottom:.25rem}
    input,select{width:100%;padding:.6rem;border:1px solid #cbd5e1;border-radius:.5rem;font-size:.95rem}
    select:focus,input:focus{outline:2px solid #94a3b8}
    button{background:#004b87;color:#fff;padding:.75rem 1.5rem;border:none;border-radius:.5rem;font-weight:600;cursor:pointer}
    button:hover{background:#003460}
    table{width:100%;border-collapse:collapse;font-size:.85rem}
    th,td{border:1px solid #cbd5e1;padding:.4rem;text-align:center}
    th{background:#f4b000;color:#fff}
    .container{max-width:1280px;margin:0 auto;padding:1rem;flex:1}
    .grid{display:grid;gap:2rem}
    @media(min-width:1280px){.grid-cols-3{grid-template-columns:200px 1fr 1fr}}
    .card{background:#fff;border-radius:1rem;padding:2rem;box-shadow:0 4px 12px rgba(0,0,0,.06)}
    .sidebar ol{counter-reset:step}
    .sidebar li{position:relative;padding-left:2.75rem;margin-bottom:2.5rem;font-weight:600}
    .sidebar li:before{counter-increment:step;content:counter(step);position:absolute;left:0;top:0;width:2rem;height:2rem;background:#f4b000;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700}
    .hidden{display:none}
    /* Hero accent */
    .hero h1:after{content:"";display:block;width:4rem;height:4px;background:#f4b000;margin:.75rem auto 0}
  </style>
</head>
<body>
  <header style="background:#fff;border-bottom:1px solid #e2e8f0">
    <div style="max-width:1280px;margin:0 auto;padding:1rem;display:flex;justify-content:space-between;align-items:center">
      <span style="font-weight:700;font-size:1.1rem">SGIP Calculator</span>
      <nav style="display:flex;gap:1.5rem;font-size:.9rem">
        <a href="#calcForm">Calculator</a>
        <a href="#rates">Rates</a>
        <a href="#about">About</a>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero" style="background:#fff;padding:3rem 1rem;box-shadow:0 1px 4px rgba(0,0,0,.04)">
    <h1>California SGIP Eligibility & Incentive Calculator</h1>
    <p style="text-align:center;max-width:600px;margin:.75rem auto 0;font-size:1rem;color:#475569">Instantly find which program track you’re in and what rebate you can expect—all offline.</p>
    <div style="text-align:center;margin-top:1.25rem"><a href="#calcForm"><button>Get Started</button></a></div>
  </section>

  <!-- MAIN GRID -->
  <main class="container grid grid-cols-3" style="margin-top:2rem">
    <!-- SIDEBAR -->
    <aside class="sidebar" style="display:none" id="sidebar-xl"></aside>

    <!-- FORM CARD -->
    <section class="card" id="calculatorCard">
      <form id="calcForm" class="form" autocomplete="off">
        <!-- Host & customer -->
        <h2>Site & Customer</h2>
        <label for="utility">Utility</label>
        <select id="utility" required><option value="">Select…</option><option value="pge">PG&E</option><option value="sce">SCE</option><option value="sdge">SDG&E</option><option value="scg">SoCalGas</option></select>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-top:1rem">
          <div>
            <label for="isCustomerOfRecord">Customer of Record?</label>
            <select id="isCustomerOfRecord" required><option value="">—</option><option value="yes">Yes</option><option value="no">No</option></select>
          </div>
          <div>
            <label for="isRented">Property Rented?</label>
            <select id="isRented" required><option value="">—</option><option value="no">No</option><option value="yes">Yes</option></select>
          </div>
        </div>

        <h2 style="margin-top:2rem">System Details</h2>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
          <div>
            <label for="capacity">Battery Capacity (kWh)</label>
            <input id="capacity" type="number" min="0" step="0.1" value="13.5" required>
          </div>
          <div>
            <label for="solarCapacity">Solar PV Size (kW)</label>
            <input id="solarCapacity" type="number" min="0" step="0.1" value="5" required>
          </div>
        </div>
        <label for="backup" style="margin-top:1rem">Backup Capability?</label>
        <select id="backup" required><option value="">—</option><option value="yes">Yes</option><option value="no">No</option></select>

        <h2 style="margin-top:2rem">Eligibility Questions</h2>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem">
          <div>
            <label for="customerType">Customer Class</label>
            <select id="customerType" required><option value="">—</option><option value="residential-single">Single‑Family</option><option value="residential-multi">Multifamily</option><option value="commercial">Commercial</option><option value="industrial">Industrial</option></select>
          </div>
          <div>
            <label for="lowIncome">Low‑Income?</label>
            <select id="lowIncome" required><option value="">—</option><option value="yes">Yes</option><option value="no">No</option></select>
          </div>
          <div>
            <label for="inDAC">Disadvantaged Community?</label>
            <select id="inDAC" required><option value="">—</option><option value="yes">Yes</option><option value="no">No</option></select>
          </div>
          <div>
            <label for="isHFTD">High‑Fire Threat?</label>
            <select id="isHFTD" required><option value="">—</option><option value="yes">Yes</option><option value="no">No</option></select>
          </div>
        </div>

        <div style="text-align:right;margin-top:1.5rem"><button type="submit">Check Eligibility</button></div>
      </form>
      <div id="result" class="card hidden" style="margin-top:1.5rem"></div>
    </section>

    <!-- RATE TABLES -->
    <section class="card" id="rates" style="overflow:auto">
      <h2>Key Incentive Rates</h2>
      <p style="margin:.5rem 0 1rem;font-size:.9rem">(Offline snapshot – verify at selfgenca.com for updates)</p>
      <table>
        <tr><th>Track</th><th style="min-width:120px">Rate</th></tr>
        <tr><td>Residential Storage Equity</td><td>$0.85 / Wh</td></tr>
        <tr><td>Equity Resiliency</td><td>$1.00 / Wh</td></tr>
        <tr><td>RSSE – Storage</td><td>$1.10 / Wh</td></tr>
        <tr><td>RSSE – Solar</td><td>$3.10 / W</td></tr>
        <tr><td>Small Residential (Step 7)</td><td>$0.15 / Wh</td></tr>
        <tr><td>Large‑Scale (Step 5)</td><td>$0.30 / Wh</td></tr>
        <tr><td>Generation Base</td><td>$2.00 / W (+$2.50 Resiliency)</td></tr>
      </table>
    </section>
  </main>

  <footer id="about" style="background:#fff;border-top:1px solid #e2e8f0;text-align:center;padding:1rem;font-size:.85rem">Made with ♥ — last offline refresh 2025‑07‑27.</footer>

  <!-- PURE JS CALCULATOR LOGIC -->
  <script>
    function val(id){return document.getElementById(id).value}
    function num(id){return parseFloat(val(id))||0}
    function yes(id){return val(id)==='yes'}

    /* ---- Static Rates (USD) ---- */
    const R={
      rsseS:1.10,rssePV:3.10,
      resEq:0.85,equRes:1.00,
      smallRes:0.15,large:0.30
    };

    function track(){
      const c=val('customerType'),li=yes('lowIncome'),dac=yes('inDAC'),h=yes('isHFTD');
      if(['residential-single','residential-multi'].includes(c)&&li){return{t:'RSSE',rate:R.rsseS,solar:R.rssePV}}
      if(['residential-single','residential-multi'].includes(c)&&dac&&h){return{t:'Equity Resiliency',rate:R.equRes}}
      if(['residential-single','residential-multi'].includes(c)&&(dac||li)){return{t:'Residential Storage Equity',rate:R.resEq}}
      if(c==='residential-single'){return{t:'Small Residential (Step 7)',rate:R.smallRes}}
      return{t:'Large‑Scale Storage (Step 5)',rate:R.large}
    }

    document.getElementById('calcForm').addEventListener('submit',e=>{
      e.preventDefault();
      const cap=num('capacity'),pv=num('solarCapacity');
      const t=track();
      const storageUSD=cap*1000*t.rate/1000; // kWh * $/Wh
      const solarUSD=t.solar?pv*1000*t.solar/1000:0; // kW * $/W
      const total=storageUSD+solarUSD;
      document.getElementById('result').innerHTML=`<h2>Result</h2>
        <p>You qualify for <strong>${t.t}</strong>.</p>
        <ul style="margin-top:.5rem;font-size:.95rem">
          <li>Storage incentive: <strong>$${storageUSD.toLocaleString()}</strong></li>
          ${solarUSD?`<li>Solar incentive: <strong>$${solarUSD.toLocaleString()}</strong></li>`:''}
          <li style="margin-top:.25rem">Estimated total rebate: <strong>$${total.toLocaleString()}</strong></li>
        </ul>`;
      document.getElementById('result').classList.remove('hidden');
      document.getElementById('result').scrollIntoView({behavior:'smooth'});
    });
  </script>
</body>
</html>
